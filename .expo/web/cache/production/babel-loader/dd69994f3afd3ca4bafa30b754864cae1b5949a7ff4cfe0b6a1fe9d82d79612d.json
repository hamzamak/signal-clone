{"ast":null,"code":"import _asyncToGenerator from\"@babel/runtime/helpers/asyncToGenerator\";import _slicedToArray from\"@babel/runtime/helpers/slicedToArray\";import StyleSheet from\"react-native-web/dist/exports/StyleSheet\";import Text from\"react-native-web/dist/exports/Text\";import TouchableOpacity from\"react-native-web/dist/exports/TouchableOpacity\";import View from\"react-native-web/dist/exports/View\";import React,{useEffect,useLayoutEffect,useState}from'react';import{SafeAreaView}from'react-native-safe-area-context';import ScrollView from\"react-native-web/dist/exports/ScrollView\";import CustomListItem from\"../components/CustomListItem\";import{Avatar}from'@rneui/themed';import{auth,db}from\"../firebase\";import{signOut}from'firebase/auth';import{AntDesign,SimpleLineIcons}from\"@expo/vector-icons\";import{collection,getDocs}from'firebase/firestore';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var HomeScreen=function HomeScreen(_ref){var navigation=_ref.navigation;var _useState=useState([]),_useState2=_slicedToArray(_useState,2),chats=_useState2[0],setChats=_useState2[1];var logOut=function logOut(){signOut(auth).then(function(){navigation.replace(\"Login\");}).catch(function(error){});};var getAllChats=function(){var _ref2=_asyncToGenerator(function*(){var querySnapshot=yield getDocs(collection(db,\"chats\"));var newData=[];querySnapshot.forEach(function(doc){newData.push({id:doc.id,data:doc.data()});});setChats(newData);});return function getAllChats(){return _ref2.apply(this,arguments);};}();useEffect(function(){getAllChats();return getAllChats;},[]);useLayoutEffect(function(){navigation.setOptions({title:\"Signal\",headerStyle:{backgroundColor:\"#fff\"},headerTitleStyle:{color:\"black\"},headerTintColor:\"black\",headerTitleAlign:\"center\",headerLeft:function headerLeft(){var _auth$currentUser;return _jsx(View,{style:{marginLeft:20},children:_jsx(TouchableOpacity,{activeOpacity:0.5,onPress:logOut,children:_jsx(Avatar,{rounded:true,source:{uri:auth==null?void 0:(_auth$currentUser=auth.currentUser)==null?void 0:_auth$currentUser.photoURL}})})});},headerRight:function headerRight(){return _jsxs(View,{style:{flexDirection:\"row\",justifyContent:\"space-between\",width:80,marginRight:20},children:[_jsx(TouchableOpacity,{activeOpacity:0.5,onPress:logOut,children:_jsx(AntDesign,{name:\"camerao\",size:24,color:\"black\"})}),_jsx(TouchableOpacity,{activeOpacity:0.5,onPress:function onPress(){return navigation.navigate(\"AddChat\");},children:_jsx(SimpleLineIcons,{name:\"pencil\",size:24,color:\"black\"})})]});}});},[navigation]);var enterChat=function enterChat(id,chatName){navigation.navigate(\"Chat\",{id:id,chatName:chatName});};return _jsx(SafeAreaView,{children:_jsx(ScrollView,{children:chats.map(function(_ref3){var id=_ref3.id,chatName=_ref3.data.chatName;return _jsx(CustomListItem,{id:id,chatName:chatName,enterChat:enterChat},id);})})});};export default HomeScreen;var styles=StyleSheet.create({});","map":{"version":3,"names":["React","useEffect","useLayoutEffect","useState","SafeAreaView","ScrollView","CustomListItem","Avatar","auth","db","signOut","AntDesign","SimpleLineIcons","collection","getDocs","jsx","_jsx","jsxs","_jsxs","HomeScreen","_ref","navigation","_useState","_useState2","_slicedToArray","chats","setChats","logOut","then","replace","catch","error","getAllChats","_ref2","_asyncToGenerator","querySnapshot","newData","forEach","doc","push","id","data","apply","arguments","setOptions","title","headerStyle","backgroundColor","headerTitleStyle","color","headerTintColor","headerTitleAlign","headerLeft","_auth$currentUser","View","style","marginLeft","children","TouchableOpacity","activeOpacity","onPress","rounded","source","uri","currentUser","photoURL","headerRight","flexDirection","justifyContent","width","marginRight","name","size","navigate","enterChat","chatName","map","_ref3","styles","StyleSheet","create"],"sources":["C:/Users/ACER/Desktop/Nouveau dossier/signal-clone/screens/HomeScreen.js"],"sourcesContent":["import { StyleSheet, Text, TouchableOpacity, View } from 'react-native'\r\nimport React, { useEffect, useLayoutEffect, useState } from 'react'\r\nimport { SafeAreaView } from 'react-native-safe-area-context'\r\nimport { ScrollView } from 'react-native'\r\nimport CustomListItem from '../components/CustomListItem'\r\nimport { Avatar } from '@rneui/themed'\r\n\r\nimport { auth, db } from '../firebase'\r\nimport { signOut } from 'firebase/auth'\r\nimport { AntDesign, SimpleLineIcons } from \"@expo/vector-icons\"\r\nimport { collection, getDocs } from 'firebase/firestore'\r\nconst HomeScreen = ({ navigation }) => {\r\n  const [chats, setChats] = useState([])\r\n  const logOut = () => {\r\n    signOut(auth).then(() => { navigation.replace(\"Login\") }).catch((error) => { });\r\n  }\r\n  const getAllChats = async () => {\r\n    //   const dbRef =  collection(db, \"chats\");\r\n    //   await getDocs(dbRef).then((docs) => {\r\n    //    setChats(docs.forEach(doc => (\r\n    //     {\r\n    //      id : doc.id, \r\n    //      data : doc.data()\r\n    //    }\r\n    //  )))\r\n\r\n    //    }) \r\n\r\n    const querySnapshot = await getDocs(collection(db, \"chats\"));\r\n    \r\n    const newData = [];\r\n        querySnapshot.forEach((doc) => {\r\n          newData.push({\r\n            id : doc.id,\r\n            data : doc.data()\r\n           });\r\n           \r\n        })\r\n        setChats(newData);\r\n       \r\n       \r\n  } \r\n \r\n  useEffect(() => {\r\n    getAllChats()\r\n  return getAllChats\r\n  }, [])\r\n\r\n  useLayoutEffect(() => {\r\n    navigation.setOptions({\r\n      title: \"Signal\",\r\n      headerStyle: { backgroundColor: \"#fff\", },\r\n      headerTitleStyle: { color: \"black\" },\r\n      headerTintColor: \"black\",\r\n      headerTitleAlign : \"center\",\r\n      headerLeft: () => (\r\n        <View style={{ marginLeft: 20 }}>\r\n          <TouchableOpacity activeOpacity={0.5} onPress={logOut}>\r\n            <Avatar rounded source={{ uri: auth?.currentUser?.photoURL }} />\r\n          </TouchableOpacity>\r\n        </View>\r\n      ),\r\n      headerRight: () => (\r\n        <View style={{ flexDirection: \"row\", justifyContent: \"space-between\", width: 80, marginRight: 20 }}>\r\n          <TouchableOpacity activeOpacity={0.5} onPress={logOut}>\r\n            <AntDesign name=\"camerao\" size={24} color=\"black\" />\r\n          </TouchableOpacity>\r\n          <TouchableOpacity activeOpacity={0.5} onPress={() => navigation.navigate(\"AddChat\")}>\r\n            <SimpleLineIcons name=\"pencil\" size={24} color=\"black\" />\r\n          </TouchableOpacity>\r\n        </View>\r\n      )\r\n    })\r\n  }, [navigation])\r\n\r\n  const enterChat = (id,chatName) => {\r\n    navigation.navigate(\"Chat\", {\r\n      id,chatName\r\n    })\r\n  }\r\n  return (\r\n    <SafeAreaView>\r\n      <ScrollView>\r\n       {\r\n        chats.map(({id , data : {chatName}}) =>(\r\n          <CustomListItem key={id} id={id} chatName={chatName} enterChat={enterChat} /> \r\n        ))\r\n       }\r\n      </ScrollView>\r\n    </SafeAreaView>\r\n  )\r\n}\r\n\r\nexport default HomeScreen\r\n\r\nconst styles = StyleSheet.create({})"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}