{"ast":null,"code":"import _slicedToArray from\"@babel/runtime/helpers/slicedToArray\";import React,{useEffect,useState}from'react';import{Avatar,ListItem}from'@rneui/themed';import{collection,doc,onSnapshot,orderBy,query}from'firebase/firestore';import{db}from\"../firebase\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var CustomListItem=function CustomListItem(_ref){var _chatMessages$,_chatMessages$$data,_chatMessages$2,_chatMessages$2$data,_chatMessages$3,_chatMessages$3$data;var id=_ref.id,chatName=_ref.chatName,enterChat=_ref.enterChat;var _useState=useState([]),_useState2=_slicedToArray(_useState,2),chatMessages=_useState2[0],setChatMessages=_useState2[1];useEffect(function(){var chatsCollection=collection(db,\"chats\");var chatDoc=doc(chatsCollection,id);var q=query(collection(chatDoc,\"messages\"),orderBy('timestamp','desc'));onSnapshot(q,function(querySnapshot){setChatMessages(querySnapshot.docs.map(function(doc){return{data:doc.data()};}));});},[]);return _jsxs(ListItem,{bottomDivider:true,onPress:function onPress(){return enterChat(id,chatName);},children:[_jsx(Avatar,{rounded:true,source:{uri:(chatMessages==null?void 0:(_chatMessages$=chatMessages[0])==null?void 0:(_chatMessages$$data=_chatMessages$.data)==null?void 0:_chatMessages$$data.photoURL)||\"https://www.seekpng.com/png/detail/110-1100707_person-avatar-placeholder.png\"}}),_jsxs(ListItem.Content,{children:[_jsx(ListItem.Title,{style:{fontWeight:\"800\"},children:chatName}),_jsxs(ListItem.Subtitle,{numberOfLines:1,ellipsizeMode:\"tail\",children:[chatMessages==null?void 0:(_chatMessages$2=chatMessages[0])==null?void 0:(_chatMessages$2$data=_chatMessages$2.data)==null?void 0:_chatMessages$2$data.displayName,\" \",chatMessages.length!=0&&\" : \",\" \",chatMessages==null?void 0:(_chatMessages$3=chatMessages[0])==null?void 0:(_chatMessages$3$data=_chatMessages$3.data)==null?void 0:_chatMessages$3$data.message]})]})]},id);};export default CustomListItem;","map":{"version":3,"names":["React","useEffect","useState","Avatar","ListItem","collection","doc","onSnapshot","orderBy","query","db","jsx","_jsx","jsxs","_jsxs","CustomListItem","_ref","_chatMessages$","_chatMessages$$data","_chatMessages$2","_chatMessages$2$data","_chatMessages$3","_chatMessages$3$data","id","chatName","enterChat","_useState","_useState2","_slicedToArray","chatMessages","setChatMessages","chatsCollection","chatDoc","q","querySnapshot","docs","map","data","bottomDivider","onPress","children","rounded","source","uri","photoURL","Content","Title","style","fontWeight","Subtitle","numberOfLines","ellipsizeMode","displayName","length","message"],"sources":["C:/Users/ACER/Desktop/Nouveau dossier/signal-clone/components/CustomListItem.js"],"sourcesContent":["\r\nimport React, { useEffect, useState } from 'react'\r\nimport { Avatar, ListItem } from '@rneui/themed'\r\nimport { collection, doc, onSnapshot, orderBy, query } from 'firebase/firestore'\r\nimport { db } from '../firebase'\r\n\r\nconst CustomListItem = ({id, chatName , enterChat}) => {\r\n  const [chatMessages , setChatMessages] = useState([])\r\n  useEffect(()=> {\r\n    const chatsCollection = collection(db, \"chats\");\r\n    const chatDoc = doc(chatsCollection, id); \r\n    const q = query(collection(chatDoc, \"messages\"), orderBy('timestamp', 'desc'))\r\n    onSnapshot(q, (querySnapshot) => { //get document data with real-time updates using the onSnapshot()\r\n    setChatMessages(querySnapshot.docs.map(doc => ({\r\n      data: doc.data()\r\n    })))\r\n  })\r\n\r\n  }, [])\r\n  return (\r\n    <ListItem key={id} bottomDivider onPress={() => enterChat(id , chatName)} >\r\n     <Avatar\r\n      rounded\r\n      source={{ uri: chatMessages?.[0]?.data?.photoURL ||\"https://www.seekpng.com/png/detail/110-1100707_person-avatar-placeholder.png\" }}\r\n    />\r\n     <ListItem.Content>\r\n      <ListItem.Title style={{fontWeight: \"800\"}}>{chatName}</ListItem.Title>\r\n      <ListItem.Subtitle numberOfLines={1} ellipsizeMode=\"tail\">\r\n        {chatMessages?.[0]?.data?.displayName   } {chatMessages.length!=0 && \" : \"} {chatMessages?.[0]?.data?.message }\r\n      </ListItem.Subtitle>\r\n    </ListItem.Content>\r\n    </ListItem>\r\n  )\r\n}\r\n\r\nexport default CustomListItem\r\n"],"mappings":"iEACA,MAAO,CAAAA,KAAK,EAAIC,SAAS,CAAEC,QAAQ,KAAQ,OAAO,CAClD,OAASC,MAAM,CAAEC,QAAQ,KAAQ,eAAe,CAChD,OAASC,UAAU,CAAEC,GAAG,CAAEC,UAAU,CAAEC,OAAO,CAAEC,KAAK,KAAQ,oBAAoB,CAChF,OAASC,EAAE,mBAAqB,OAAAC,GAAA,IAAAC,IAAA,gCAAAC,IAAA,IAAAC,KAAA,yBAEhC,GAAM,CAAAC,cAAc,CAAG,QAAjB,CAAAA,cAAcA,CAAAC,IAAA,CAAmC,KAAAC,cAAA,CAAAC,mBAAA,CAAAC,eAAA,CAAAC,oBAAA,CAAAC,eAAA,CAAAC,oBAAA,IAA9B,CAAAC,EAAE,CAAAP,IAAA,CAAFO,EAAE,CAAEC,QAAQ,CAAAR,IAAA,CAARQ,QAAQ,CAAGC,SAAS,CAAAT,IAAA,CAATS,SAAS,CAC/C,IAAAC,SAAA,CAAyCxB,QAAQ,CAAC,EAAE,CAAC,CAAAyB,UAAA,CAAAC,cAAA,CAAAF,SAAA,IAA9CG,YAAY,CAAAF,UAAA,IAAGG,eAAe,CAAAH,UAAA,IACrC1B,SAAS,CAAC,UAAK,CACb,GAAM,CAAA8B,eAAe,CAAG1B,UAAU,CAACK,EAAE,CAAE,OAAO,CAAC,CAC/C,GAAM,CAAAsB,OAAO,CAAG1B,GAAG,CAACyB,eAAe,CAAER,EAAE,CAAC,CACxC,GAAM,CAAAU,CAAC,CAAGxB,KAAK,CAACJ,UAAU,CAAC2B,OAAO,CAAE,UAAU,CAAC,CAAExB,OAAO,CAAC,WAAW,CAAE,MAAM,CAAC,CAAC,CAC9ED,UAAU,CAAC0B,CAAC,CAAE,SAACC,aAAa,CAAK,CACjCJ,eAAe,CAACI,aAAa,CAACC,IAAI,CAACC,GAAG,CAAC,SAAA9B,GAAG,QAAK,CAC7C+B,IAAI,CAAE/B,GAAG,CAAC+B,IAAI,EAChB,CAAC,EAAC,CAAC,CAAC,CACN,CAAC,CAAC,CAEF,CAAC,CAAE,EAAE,CAAC,CACN,MACE,CAAAvB,KAAA,CAACV,QAAQ,EAAUkC,aAAa,MAACC,OAAO,CAAE,SAAAA,QAAA,QAAM,CAAAd,SAAS,CAACF,EAAE,CAAGC,QAAQ,CAAC,EAAC,CAAAgB,QAAA,EACxE5B,IAAA,CAACT,MAAM,EACNsC,OAAO,MACPC,MAAM,CAAE,CAAEC,GAAG,CAAE,CAAAd,YAAY,eAAAZ,cAAA,CAAZY,YAAY,CAAG,CAAC,CAAC,gBAAAX,mBAAA,CAAjBD,cAAA,CAAmBoB,IAAI,eAAvBnB,mBAAA,CAAyB0B,QAAQ,GAAG,8EAA+E,CAAE,EACpI,CACD9B,KAAA,CAACV,QAAQ,CAACyC,OAAO,EAAAL,QAAA,EAChB5B,IAAA,CAACR,QAAQ,CAAC0C,KAAK,EAACC,KAAK,CAAE,CAACC,UAAU,CAAE,KAAK,CAAE,CAAAR,QAAA,CAAEhB,QAAQ,EAAkB,CACvEV,KAAA,CAACV,QAAQ,CAAC6C,QAAQ,EAACC,aAAa,CAAE,CAAE,CAACC,aAAa,CAAC,MAAM,CAAAX,QAAA,EACtDX,YAAY,eAAAV,eAAA,CAAZU,YAAY,CAAG,CAAC,CAAC,gBAAAT,oBAAA,CAAjBD,eAAA,CAAmBkB,IAAI,eAAvBjB,oBAAA,CAAyBgC,WAAW,CAAI,GAAC,CAACvB,YAAY,CAACwB,MAAM,EAAE,CAAC,EAAI,KAAK,CAAC,GAAC,CAACxB,YAAY,eAAAR,eAAA,CAAZQ,YAAY,CAAG,CAAC,CAAC,gBAAAP,oBAAA,CAAjBD,eAAA,CAAmBgB,IAAI,eAAvBf,oBAAA,CAAyBgC,OAAO,GAC3F,GACH,GAVJ/B,EAAE,CAWN,CAEf,CAAC,CAED,cAAe,CAAAR,cAAc"},"metadata":{},"sourceType":"module","externalDependencies":[]}